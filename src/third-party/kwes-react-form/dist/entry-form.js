import{jsxs as u,jsx as l,Fragment as _}from"react/jsx-runtime";import*as T from"react";import y,{forwardRef as F,useRef as x,Fragment as L}from"react";const g=({help:e,children:a})=>u("div",{className:"field",children:[l("div",{className:"control",children:a}),e&&l("p",{className:"help",children:e})]}),A=({className:e,help:a,label:s,...r})=>l(g,{help:a,label:s,children:u("label",{className:e,children:[r.children," Â ",s]})}),R=({value:e,rules:a,name:s,checked:r,...n})=>l("input",{name:s,type:"checkbox",checked:r,value:e,...n}),z=({name:e,label:a,rules:s,help:r,className:n,...i})=>l(A,{name:e,label:a,rules:s,help:r,className:n,children:l(R,{name:e,...i})}),G=e=>{var s;T.useState(new Array(Object.entries(e.options).length).fill(!1));const a=(s=e==null?void 0:e.rules)!=null&&s.includes("required")?"label required":"label";return l(g,{label:e.label,help:e.help,children:u("fieldset",{"data-kw-group":!0,className:"kw-checkbox-group",rules:e.rules,children:[l("legend",{className:a,children:e.label}),e.options&&Object.entries(e.options).map(([r,n],i)=>l(z,{name:e.name,value:n,label:r},`${e.name}-${i}`))]})})};function O(e){const[a,s]=T.useState(!1);return T.useEffect(()=>{const r=new MutationObserver(function(n){for(const i of n)i.type==="attributes"&&(i.target.classList.contains("kw-border-error")&&s(!0),i.target.classList.contains("kw-border-success")&&s(!1))});return e.current&&r.observe(e.current,{attributes:!0,childList:!1,subtree:!1}),()=>{r.disconnect()}}),a}const D=F((e,a)=>l("input",{ref:a,id:`${e.name}-input`,"data-testid":`${e.name}-input`,className:["input",e.className?e.className:""].join(" ").trim(),...e}));D.displayName="InputField";const $=e=>{var i,t;const a=x(null),s=O(a),r={"aria-describedby":`field-error-${e.name}`,"aria-invalid":s||""},n=(i=e==null?void 0:e.rules)!=null&&i.includes("required")?"label required":"label";return l(g,{label:e.label,help:e.help,children:u(L,{children:[e.type!=="hidden"&&l("label",{className:n,htmlFor:`${e.name}-input`,children:e.label}),l(D,{ref:a,id:`${e.name}-input`,"data-testid":`${e.name}-input`,rules:e.rules,...e.type!=="hidden"&&s&&{...r},...e,className:["input",e.className].join(" ").trim(),required:!!((t=e==null?void 0:e.rules)!=null&&t.includes("required"))})]})})},H=({name:e,label:a,onChange:s,value:r})=>l(_,{children:u("label",{children:[l("input",{onChange:s,type:"radio",name:e,value:r})," ",a]},a)}),P=e=>{var s;const a=(s=e==null?void 0:e.rules)!=null&&s.includes("required")?"label required":"label";return u("div",{className:"field",children:[l("div",{className:"control radio-control",children:u("fieldset",{"data-kw-group":!0,...e.rules&&{rules:e.rules},children:[l("legend",{className:a,children:e.label}),Object.entries(e.options).map(([r,n])=>l(H,{label:r,name:e.name,value:n,options:{[r]:n},onChange:e.onChange},r))]})}),e.help&&l("p",{className:"help",children:e.help})]})},V=F((e,a)=>l("select",{ref:a,id:`${e.name}-select`,"data-testid":`${e.name}-select`,className:["select",e.className?e.className:""].join(" ").trim(),...e,children:e.children}));V.displayName="SelectField";const B=({name:e,className:a,type:s,label:r,rules:n,defaultOption:i,multiple:t,size:c,help:m,options:o})=>{const[d,f]=y.useState(i||""),b=x(null),k=O(b),N={"aria-describedby":`field-error-${e}`,"aria-invalid":k||""},w=n!=null&&n.includes("required")?"label required":"label";return l(g,{label:r,help:m,children:u(L,{children:[s!=="hidden"&&l("label",{className:w,htmlFor:`${e}-input`,children:r}),l("div",{className:`control is-fullwidth select ${t?"is-multiple":""} ${k?"has-error is-danger":""} ${a||""}`,children:u(V,{ref:b,id:`${e}-select`,name:e,rules:n,onChange:v=>f(v.currentTarget.value),...d&&!t&&!i&&{value:d},...t&&{multiple:t},...t&&c&&{size:c},...N,children:[!i&&l("option",{value:"",children:"Select One"}),i!==void 0&&typeof i=="object"&&l("option",{value:Object.values(i)[0].value,selected:!0,children:Object.keys(i)[0]}),Object.entries(o).map(([v,j])=>l("option",{value:j.value,children:v},v))]})})]})})},J=({name:e,rules:a,label:s,help:r,className:n,...i})=>{const[t,c]=y.useState(i.defaultValue||""),m=x(null),o=O(m),d={"aria-describedby":`field-error-${e}`},f=a!=null&&a.includes("required")?"label required":"label";return u(g,{help:r,label:s,children:[i.type!=="hidden"&&l("label",{className:f,htmlFor:`${e}-input`,children:s}),l("textarea",{ref:m,id:`${e}-textarea`,"data-testid":`${e}-textarea`,name:e,className:["textarea",i.type,n].join(" "),onChange:b=>c(b.currentTarget.value),...a?{rules:a}:{},...o?{...d}:{},placeholder:i.placeholder,rows:i.rows||void 0,value:t||""})]})},h=({className:e,help:a,label:s,...r})=>u(g,{help:a,label:s,children:[l("label",{className:[e,"label"].join(" "),htmlFor:r.name,children:s}),l("div",{children:r.children})]}),K=({value:e,rules:a,name:s,checked:r,...n})=>l("input",{name:s,type:"file",className:"input",value:e,rules:a,...n}),Q=({name:e,label:a,rules:s,help:r,className:n,...i})=>l(h,{name:e,label:a,rules:s,help:r,className:n,children:l(K,{name:e,rules:s,...i})}),U=({min:e,max:a,value:s,rules:r,name:n,checked:i,...t})=>l("input",{name:n,type:"date",className:"input",value:s,min:e,max:a,rules:r,...t}),W=({name:e,label:a,rules:s,help:r,className:n,...i})=>l(h,{name:e,label:a,rules:s,help:r,className:[n,"kw-datepicker-wrapper"].join(" "),children:l(U,{name:e,rules:s,...i})}),X=({value:e,rules:a,name:s,checked:r,...n})=>l("div",{className:"kw-datepicker-wrapper",children:l("input",{name:s,type:"datepicker",value:e,className:"input",rules:a,...n})}),Y=({name:e,label:a,rules:s,help:r,className:n,...i})=>l(h,{name:e,label:a,rules:s,help:r,className:n,children:l(X,{name:e,rules:s,...i})}),Z=({min:e,max:a,rules:s,name:r,...n})=>{const[i,t]=y.useState(null);return l("input",{type:"datetime-local",className:"input",name:r,value:i||"",min:e,max:a,rules:s,onChange:c=>t(c.currentTarget.value),...n})},ee=({name:e,min:a,max:s,label:r,rules:n,help:i,className:t,...c})=>l(h,{name:e,label:r,rules:n,help:i,className:[t,"kw-datepicker-wrapper"].join(" "),children:l(Z,{name:e,min:a,rules:n,max:s,...c})}),le=({min:e,max:a,value:s,rules:r,name:n,checked:i,...t})=>l("input",{name:n,type:"time",className:"input timepicker",value:s,min:e,max:a,rules:r,...e&&a&&{title:`Time should be between ${new Date(`${new Date().toLocaleString().split(",").shift()} ${e}`).toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0})} and ${new Date(`${new Date().toLocaleString().split(",").shift()} ${a}`).toLocaleTimeString([],{hour:"numeric",minute:"2-digit",hour12:!0})}`},...t}),ae=({name:e,label:a,rules:s,help:r,className:n,...i})=>l(h,{name:e,label:a,rules:s,help:r,className:[n,"kw-timepicker-wrapper"].join(" "),children:l(le,{name:e,rules:s,...i})}),se=({help:e,value:a,name:s,pattern:r,checked:n,...i})=>l("input",{name:s,type:"tel",className:["input input-tel",i==null?void 0:i.className].join(" ").trim(),value:a,pattern:r,"aria-label":e,...i}),re=({name:e,rules:a,label:s,help:r,className:n,...i})=>l(h,{name:e,label:s,help:r,className:[n,"kw-tel-wrapper",a!=null&&a.includes("required")?"required":""].join(" "),children:l(se,{name:e,help:r,...i})}),ne=({defaultValue:e,min:a,max:s,value:r,rules:n,name:i,pattern:t,...c})=>l("input",{name:i,type:"number",className:["input",c==null?void 0:c.className].join(" ").trim(),value:r??e,rules:n,min:a,max:s,...c}),E=({min:e,max:a,step:s,name:r,label:n,rules:i,help:t,className:c,...m})=>l(h,{name:r,label:n,rules:i,help:t,className:[c,"kw-tel-wrapper"].join(" "),children:l(ne,{min:e,max:a,step:s,name:r,rules:i,...m})}),ie=({defaultValue:e,min:a,max:s,step:r,rules:n,name:i,checked:t,...c})=>{const[m,o]=y.useState(e??"");return u("div",{className:"range-input-wrapper",children:[l("input",{name:i,className:"range-input",type:"range",value:m,...n&&{rules:n},...a&&{min:a},...s&&{max:s},...r&&{step:r},onChange:d=>o(d.currentTarget.value),...c}),l(E,{onChange:d=>o(d.currentTarget.value),...c,id:`${i}-input`,type:"number","data-testid":`${i}-input`,value:m,rules:n,required:!!(n!=null&&n.includes("required"))})]})},te=({name:e,label:a,rules:s,help:r,className:n,...i})=>l(h,{name:e,label:a,rules:s,help:r,className:[n,"kw-tel-wrapper"].join(" "),children:l(ie,{name:e,rules:s,...i})}),ce={select:e=>l(B,{...e}),text:e=>l($,{...e}),textarea:e=>l(J,{...e}),password:e=>l($,{...e}),email:e=>l($,{...e}),file:e=>l(Q,{...e}),date:e=>l(W,{...e}),datepicker:e=>l(Y,{...e}),hidden:e=>l($,{...e}),checkbox:e=>l(z,{...e}),checkboxGroup:e=>l(G,{...e}),radio:e=>l(P,{...e}),time:e=>l(ae,{...e}),"datetime-local":e=>l(ee,{...e}),tel:e=>l(re,{...e}),range:e=>l(te,{...e}),number:e=>l(E,{...e})};function S(e){return(0,ce[e.type])({...e,key:e.name})}const de=({id:e,data:a,action:s,handler:r})=>{var f,b,k;const n=x(null),i=s??`https://kwes.io/api/foreign/forms/${e}`,t=a.disclaimer,c=((f=a.submission)==null?void 0:f.button)||"Submit",m=((b=a.submission)==null?void 0:b.success)||null,o=((k=a.submission)==null?void 0:k.error)||null;return l("form",{className:"kwes-form",...s?null:{method:"POST"},...s?null:{noValidate:!0},acceptCharset:"utf-8",ref:n,action:i,...r&&{onSubmit:r},...m&&{"success-message":m},...o&&{"error-message":o},children:a&&u("fieldset",{className:"container",children:[a.title&&l("div",{className:"columns",children:u("div",{className:"column",children:[l("span",{className:"h2",children:a.title}),l("br",{}),a.subTitle&&l("span",{children:a.subTitle})]})}),a.fields&&(d=a.fields,d.map((N,w)=>{const v=Object.keys(N)[0]==="group",j=N.type==="hidden";let C;const q=[];return v?(N.group.forEach((p,I)=>{C=p.field.name;const M=p!=null&&p.size?["column",`is-${p.size}`]:["column"];q.push(l("div",{className:M.join(" "),children:S(p.field)},`group-${I}`))}),l("div",{className:"columns",children:q&&q.map(p=>p)},`group-column-${C}`)):j===!1&&v===!1?l("div",{className:"columns",children:l("div",{className:"column",children:S(N)})},`group-${w}`):l("div",{className:"hidden",children:S(N)},`field-${w}`)})),l("div",{className:"field is-grouped is-grouped-centered",children:l("p",{className:"control",children:l("button",{"data-testid":"submit-button",className:"button is-info is-primary is-fullwidth submit-button is-normal",type:"submit",children:c})})}),t&&l("div",{className:"columns",children:l("div",{className:"column",children:l("p",{className:"disclaimer",dangerouslySetInnerHTML:{__html:t}})})})]})});var d};export{de as default};
